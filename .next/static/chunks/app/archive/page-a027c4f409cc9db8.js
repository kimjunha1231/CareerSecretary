(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[635],{7097:(e,t,r)=>{Promise.resolve().then(r.bind(r,5417))},5417:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var i=r(5155),s=r(2115),o=r(351),a=r(5828);let n=(0,a.createServerReference)("40fe40283b429faf19b3d706a0f389c5fe9d9ad02a",a.callServer,void 0,a.findSourceMapURL,"updateDocumentOrder");var c=r(853),l=r(4081),d=r(5686),u=r(8633),m=r(3344),h=r(6046),x=r(1812),p=r(3561),f=r(6329);function g(e){let{doc:t,onDelete:r}=e,s=(0,h.useRouter)(),{attributes:o,listeners:a,setNodeRef:n,transform:c,transition:u,isDragging:m}=(0,p.gl)({id:t.id}),x={transform:f.Ks.Transform.toString(c),transition:u,zIndex:m?10:1,opacity:m?.5:1};return(0,i.jsxs)("div",{ref:n,style:x,...o,...a,onClick:()=>s.push("/document/".concat(t.id)),className:"bg-surface border border-white/5 rounded-xl p-5 hover:border-primary/50 transition-all cursor-pointer group relative",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,i.jsx)("div",{className:"w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center text-zinc-400 group-hover:text-white transition-colors",children:(0,i.jsx)(l.A,{size:20})}),(0,i.jsx)("button",{onClick:e=>{e.stopPropagation(),r(t.id)},className:"text-zinc-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",onPointerDown:e=>e.stopPropagation(),children:(0,i.jsx)(d.A,{size:16})})]}),(0,i.jsx)("h3",{className:"text-lg font-medium text-white mb-1",children:t.company}),(0,i.jsx)("p",{className:"text-sm text-zinc-400",children:t.role})]})}function y(){let{documents:e,deleteDocument:t}=(0,o.U)(),[r,a]=(0,s.useState)(""),[f,y]=(0,s.useState)(e),[j,b]=(0,s.useState)(null),w=(0,h.useRouter)(),v=(0,x.FR)((0,x.MS)(x.AN,{activationConstraint:{delay:250,tolerance:5}}),(0,x.MS)(x.uN,{coordinateGetter:p.JR}));s.useEffect(()=>{y(e)},[e]);let N=r?f.filter(e=>e.company.toLowerCase().includes(r.toLowerCase())||e.role.toLowerCase().includes(r.toLowerCase())):f,z=async e=>{let{active:t,over:r}=e;if(r&&t.id!==r.id){let e=f.findIndex(e=>e.id===t.id),i=f.findIndex(e=>e.id===r.id),s=(0,p.be)(f,e,i);y(s);let o=s.map((e,t)=>({id:e.id,position:t}));try{await n(o)}catch(e){console.error("Failed to update order:",e)}}b(null)},E=j?f.find(e=>e.id===j):null;return(0,i.jsxs)("div",{className:"pb-20",children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"아카이브"}),(0,i.jsx)("p",{className:"text-zinc-400",children:"저장된 자기소개서를 관리하세요"})]}),(0,i.jsxs)("div",{className:"relative mb-6",children:[(0,i.jsx)(c.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500",size:18}),(0,i.jsx)("input",{type:"text",placeholder:"회사명 또는 직무로 검색...",value:r,onChange:e=>a(e.target.value),className:"w-full bg-surface border border-white/10 rounded-lg pl-10 pr-4 py-3 text-white placeholder-zinc-500 focus:outline-none focus:border-primary transition-colors"})]}),r?(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(0,i.jsx)(u.N,{children:N.map((e,r)=>(0,i.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},transition:{delay:.05*r},onClick:()=>w.push("/document/".concat(e.id)),className:"bg-surface border border-white/5 rounded-xl p-5 hover:border-primary/50 transition-all cursor-pointer group",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,i.jsx)("div",{className:"w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center text-zinc-400 group-hover:text-white transition-colors",children:(0,i.jsx)(l.A,{size:20})}),(0,i.jsx)("button",{onClick:r=>{r.stopPropagation(),t(e.id)},className:"text-zinc-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,i.jsx)(d.A,{size:16})})]}),(0,i.jsx)("h3",{className:"text-lg font-medium text-white mb-1",children:e.company}),(0,i.jsx)("p",{className:"text-sm text-zinc-400",children:e.role})]},e.id))})}):(0,i.jsxs)(x.Mp,{sensors:v,collisionDetection:x.fp,onDragStart:e=>{b(e.active.id)},onDragEnd:z,children:[(0,i.jsx)(p.gB,{items:f.map(e=>e.id),strategy:p.kL,children:(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(e=>(0,i.jsx)(g,{doc:e,onDelete:t},e.id))})}),(0,i.jsx)(x.Hd,{children:E?(0,i.jsxs)("div",{className:"bg-surface border border-primary/50 rounded-xl p-5 shadow-2xl scale-105 cursor-grabbing",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,i.jsx)("div",{className:"w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center text-white transition-colors",children:(0,i.jsx)(l.A,{size:20})}),(0,i.jsx)("button",{className:"text-zinc-600",children:(0,i.jsx)(d.A,{size:16})})]}),(0,i.jsx)("h3",{className:"text-lg font-medium text-white mb-1",children:E.company}),(0,i.jsx)("p",{className:"text-sm text-zinc-400",children:E.role})]}):null})]}),0===N.length&&(0,i.jsxs)("div",{className:"text-center py-20 text-zinc-500",children:[(0,i.jsx)(l.A,{size:48,className:"mx-auto mb-4 opacity-20"}),(0,i.jsx)("p",{children:"저장된 문서가 없습니다."})]})]})}},351:(e,t,r)=>{"use strict";r.d(t,{DocumentProvider:()=>a,U:()=>n});var i=r(5155),s=r(2115);let o=(0,s.createContext)(void 0),a=e=>{let{children:t}=e,[r,a]=(0,s.useState)([]),[n,c]=(0,s.useState)(!0),l=async()=>{try{c(!0);let e=await fetch("/api/documents");if(401===e.status){a([]);return}if(!e.ok)throw Error("Failed to fetch documents");let t=(await e.json()).map(e=>({id:e.id,title:e.title,company:e.company,role:e.role,content:e.content,createdAt:new Date(e.created_at).toISOString().split("T")[0],jobPostUrl:e.job_post_url,status:e.status||"pending",tags:e.tags||[]}));a(t)}catch(e){console.error("Error fetching documents:",e)}finally{c(!1)}};(0,s.useEffect)(()=>{l()},[]);let d=async e=>{try{if(!(await fetch("/api/documents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to create document");await l()}catch(e){throw console.error("Error creating document:",e),e}},u=async e=>{try{if(!(await fetch("/api/documents?id=".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete document");await l()}catch(e){throw console.error("Error deleting document:",e),e}},m=async(e,t)=>{try{if(!(await fetch("/api/documents?id=".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to update document");await l()}catch(e){throw console.error("Error updating document:",e),e}},h={total:r.length,companies:new Set(r.map(e=>e.company)).size,lastActive:r.length>0?r[0].createdAt:"N/A"};return(0,i.jsx)(o.Provider,{value:{documents:r,addDocument:d,deleteDocument:u,updateDocument:m,stats:h,isLoading:n,refreshDocuments:l},children:t})},n=()=>{let e=(0,s.useContext)(o);if(!e)throw Error("useDocuments must be used within a DocumentProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[615,799,441,517,358],()=>t(7097)),_N_E=e.O()}]);